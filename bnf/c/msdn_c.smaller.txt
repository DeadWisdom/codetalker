

### C.1.4 Tokens

literal:
    boolean-literal
    integer-literal
    real-literal
    character-literal
    string-literal
    null-literal

### C.2 Syntactic grammar

### C.2.1 Basic concepts

start:
    compilation-unit

namespace-name:
    namespace-or-type-name

type-name:
    namespace-or-type-name

namespace-or-type-name:
    identifier dot-identifier*

dot-identifier:
    '.'   identifier

### C.2.2 Types

type:
    type-sub '*'*

type-sub:
    value-type
    reference-type

value-type:
    struct-type
    enum-type

struct-type:
    type-name
    simple-type

simple-type:
    numeric-type
    'bool'

numeric-type:
    integral-type
    floating-point-type
    'decimal'

integral-type: one of
    sbyte
    byte
    short
    ushort
    int
    uint
    long
    ulong
    char

floating-point-type: one of
    float
    double

enum-type:
    type-name

reference-type:
    class-type
    interface-type
    array-type
    delegate-type

class-type:
    type-name
    'object'
    'string'

interface-type:
    type-name

rank-specifier:
    '['   ','+   ']'

#dim-separators:
#    ','
#    dim-separators   ','

delegate-type:
    type-name

### C.2.3 Variables

variable-reference:
    expression

### C.2.4 Expressions

argument-list:
    argument argument-list-tail*

argument-list-tail:
    ',' argument

argument:
    expression
    'ref'   variable-reference
    'out'   variable-reference

primary-expression:
    primary-no-array-creation-expression
    array-creation-expression

primary-no-array-creation-expression:
    primary-no-array-sub primary-no-array-tail*

primary-no-array-tail:
    '.' identifier
    '(' argument-list? ')'
    '[' expression-list ']'
    '++'
    '--'

primary-no-array-sub:
    literal
    simple-name
    parenthesized-expression
    member-access
    this-access
    base-access
    object-creation-expression
    delegate-creation-expression
    typeof-expression
    sizeof-expression
    checked-expression
    unchecked-expression

simple-name:
    identifier

parenthesized-expression:
    '('   expression   ')'

# TODO: used to also have primary-expression.identifier;
# this could prevent you from doing 'new abc[3].foo
member-access:
    predefined-type   '.'   identifier

predefined-type: one of
    bool byte char decimal double float int long object sbyte short string uint ulong ushort

invocation-expression:
    primary-expression   '('   argument-list?   ')'

expression-list:
    expression expression-list-tail*

expression-list-tail:
    ',' expression

this-access:
    'this'

base-access:
    'base'   '.'   identifier
    'base'   '['   expression-list   ']'

post-increment-expression:
    primary-expression   '++'

post-decrement-expression:
    primary-expression   '--'

object-creation-expression:
    'new'   type   '('   argument-list?   ')'

array-creation-expression:
    'new'   non-array-type   '['   expression-list   ']'   rank-specifier*   array-initializer?
    'new'   array-type   array-initializer

delegate-creation-expression:
    'new'   delegate-type   '('   expression   ')'

typeof-expression:
    'typeof(void'   ')'
    'typeof'   '('   type   ')'
sizeof-expression:
    'sizeof(void'   ')'
    'sizeof('   type   ')'

checked-expression:
    'checked'   '('   expression   ')'

unchecked-expression:
    'unchecked'   '('   expression   ')'

unary-expression:
    '+'   unary-expression
    '-'   unary-expression
    '!'   unary-expression
    '~'   unary-expression
    '*'   unary-expression
    '&'   unary-expression
    pre-increment-expression
    pre-decrement-expression
    cast-expression
    primary-expression

pre-increment-expression:
    '++'   unary-expression

pre-decrement-expression:
    '--'   unary-expression

cast-expression:
    '('   type   ')'   unary-expression

multiplicative-expression:
    unary-expression multiplicative-right?

multiplicative-right:
    mul-op multiplicative-expression

mul-op: one of
    * / %

additive-expression:
    multiplicative-expression   add-right?

add-right:
    '+'   additive-expression
    '-'   additive-expression

shift-expression:
    additive-expression shift-right?

shift-right:
    shift-op shift-expression?

shift-op:one of
    << >>

relational-expression:
    shift-expression relational-right?
## was 'relational' (on the left) for 'is' and 'as'. is this valid? TODO

relational-right:
    rel-op relational-expression
    'is' type
    'as' type

rel-op:one of
    < > <= >=

equality-expression:
    relational-expression equality-right?

equality-right:
    equ-op equality-expression

equ-op:one of
    == !=

and-expression:
    equality-expression and-right?

and-right:
    '&' and-expression

exclusive-or-expression:
    and-expression ex-or-right?

ex-or-right:
    '^' exclusive-or-expression

inclusive-or-expression:
    exclusive-or-expression inclusive-or-expression-right?

inclusive-or-expression-right:
      '|'   inclusive-or-expression

conditional-and-expression:
    inclusive-or-expression conditional-and-expression-right?

conditional-and-expression-right:
      '&&'   conditional-and-expression

conditional-or-expression:
    conditional-and-expression conditional-or-expression-right?

conditional-or-expression-right:
      '||'   conditional-or-expression   

conditional-expression:
    conditional-or-expression conditional-expression-right?

conditional-expression-right:
      '?'   expression   ':'   expression

assignment:
    unary-expression   assignment-operator   expression

assignment-operator: one of
    =   +=   -=   *=   /=   %=   &=   |=   ^=   <<=   >>=

expression:
    conditional-expression
    assignment

constant-expression:
    expression

### C.2.5 Statements

statement:
    labeled-statement
    declaration-statement
    embedded-statement

embedded-statement:
    block
    empty-statement
    expression-statement
    selection-statement
    iteration-statement
    jump-statement
    try-statement
    checked-statement
    unchecked-statement
    lock-statement
    using-statement

block:
    '{'   statement*   '}'

empty-statement:
    ';'

labeled-statement:
    identifier   ':'   statement

declaration-statement:
    local-variable-declaration   ';'
    local-constant-declaration   ';'

local-variable-declaration:
    type   local-variable-declarators

local-variable-declarators:
    local-variable-declarator local-variable-declarator-list*

local-variable-declarator-list:
    ','   local-variable-declarator

local-variable-declarator:
    identifier   '='   local-variable-initializer
    identifier

local-variable-initializer:
    auto-rule-3

local-constant-declaration:
    'const'   type   constant-declarators

constant-declarators:
    constant-declarator constant-declarator-tail*

constant-declarator-tail:
    ',' constant-declarator

constant-declarator:
    identifier   '='   constant-expression

expression-statement:
    statement-expression   ';'

statement-expression:
    invocation-expression
    object-creation-expression
    assignment
    post-increment-expression
    post-decrement-expression
    pre-increment-expression
    pre-decrement-expression
    primary-expression

selection-statement:
    if-statement
    switch-statement

if-statement:
    'if'   '('   boolean-expression   ')'   embedded-statement   'else'   embedded-statement
    'if'   '('   boolean-expression   ')'   embedded-statement

boolean-expression:
    expression

switch-statement:
    'switch'   '('   expression   ')'   switch-block

switch-block:
    '{'   switch-section*   '}'

switch-section:
    switch-label+   statement*
## used to be statement-list. where did that do? is this legal? TODO

switch-label:
    'case'   constant-expression   ':'
    'default'   ':'

iteration-statement:
    while-statement
    do-statement
    for-statement
    foreach-statement

while-statement:
    'while'   '('   boolean-expression   ')'   embedded-statement

do-statement:
    'do'   embedded-statement   'while'   '('   boolean-expression   ')'   ';'

for-statement:
    'for'   '('   for-initializer?   ';'   for-condition?   ';'   for-iterator?   ')'   embedded-statement

for-initializer:
    local-variable-declaration
    statement-expression-list

for-condition:
    boolean-expression

for-iterator:
    statement-expression-list

statement-expression-list:
    statement-expression statement-expression-tail*

statement-expression-tail:
    ','   statement-expression

foreach-statement:
    'foreach'   '('   type   identifier   'in'   expression   ')'   embedded-statement

jump-statement:
    break-statement
    continue-statement
    goto-statement
    return-statement
    throw-statement

break-statement:
    'break'   ';'

continue-statement:
    'continue'   ';'

goto-statement:
    'goto'   identifier   ';'
    'goto'   'case'   constant-expression   ';'
    'goto'   'default'   ';'

return-statement:
    'return'   expression?   ';'

throw-statement:
    'throw'   expression?   ';'

try-statement:
    'try'   block try-right

try-right:
    finally-clause
    catch-clauses finally-clause?

catch-clauses:
    specific-catch-clause+   general-catch-clause?
    specific-catch-clause*   general-catch-clause

specific-catch-clause:
    'catch'   '('   class-type   identifier?   ')'   block

general-catch-clause:
    'catch'   block

finally-clause:
    'finally'   block

checked-statement:
    'checked'   block

unchecked-statement:
    'unchecked'   block

lock-statement:
    'lock'   '('   expression   ')'   embedded-statement

using-statement:
    'using'   '('    resource-acquisition   ')'    embedded-statement

resource-acquisition:
    local-variable-declaration
    expression

### C.2.6 Namespaces

compilation-unit:
    using-directive*   global-attributes?   namespace-member-declaration*

namespace-declaration:
    'namespace'   qualified-identifier   namespace-body   ';'?

qualified-identifier:
    identifier dot-identifier*

namespace-body:
    '{'   using-directive*   namespace-member-declaration*   '}'

using-directive:
    using-alias-directive
    using-namespace-directive

using-alias-directive:
    'using'   identifier   '='   namespace-or-type-name   ';'

using-namespace-directive:
    'using'   namespace-name   ';'

namespace-member-declaration:
    namespace-declaration
    type-declaration
    pp-line

type-declaration:
    class-declaration
    struct-declaration
    interface-declaration
    enum-declaration
    delegate-declaration
    method-declaration

### C.2.7 Classes

class-declaration:
    attributes?   class-modifier*   'class'   identifier   class-base?   class-body   ';'?

class-modifier: one of
    new
    public
    protected
    internal
    private
    abstract
    sealed

class-base:
    ':' class-base-right

class-base-right:
    interface-type-list
    class-type   class-base-right2?

class-base-right2:
    ','   interface-type-list

interface-type-list:
    interface-type interface-type-tail*

interface-type-tail:
    ','   interface-type

class-body:
    '{'   class-member-declaration*   '}'

class-member-declaration:
    constant-declaration
    field-declaration
    method-declaration
    property-declaration
    event-declaration
    indexer-declaration
    operator-declaration
    constructor-declaration
    destructor-declaration
    static-constructor-declaration
    type-declaration

constant-declaration:
    attributes?   constant-modifier*   'const'   type   constant-declarators   ';'

constant-modifier:
    auto-rule-2

field-declaration:
    attributes?   field-modifier*   type   variable-declarators   ';'

field-modifier: one of
    new
    public
    protected
    internal
    private
    static
    readonly
    volatile

variable-declarators:
    variable-declarator variable-declarator-tail*

variable-declarator-tail:
    ','   variable-declarator

variable-declarator:
    identifier   vbl-dec-right?

vbl-dec-right:
    '='   variable-initializer

variable-initializer:
    auto-rule-3

method-declaration:
    method-header   method-body

method-header:
    attributes?   method-modifier*   return-type   member-name   '('   formal-parameter-list?   ')'

method-modifier:
    auto-rule-4

return-type:
    type
    'void'

member-name:
    identifier
    interface-type   '.'   identifier

method-body:
    auto-rule-1

formal-parameter-list:
    fixed-parameters formal-p-right?
    parameter-array

formal-p-right:
    ','   parameter-array

fixed-parameters:
    fixed-parameter fixed-parameter-tail*

fixed-parameter-tail:
    ','   fixed-parameter

fixed-parameter:
    attributes?   parameter-modifier?   type   identifier arraybit?

arraybit:
    '[' ']'

parameter-modifier: one of
    ref
    out
    const

parameter-array:
    attributes?   'params'   array-type   identifier

property-declaration:
    attributes?   property-modifier*   type   member-name   '{'   accessor-declarations   '}'

property-modifier:
    auto-rule-4

accessor-declarations:
    get-accessor-declaration   set-accessor-declaration?
    set-accessor-declaration   get-accessor-declaration?

get-accessor-declaration:
    attributes?   'get'   accessor-body

set-accessor-declaration:
    attributes?   'set'   accessor-body

accessor-body:
    auto-rule-1

event-declaration:
    attributes?   event-modifier*   'event'   type   variable-declarators   ';'
    attributes?   event-modifier*   'event'   type   member-name   '{'   event-accessor-declarations   '}'

event-modifier:
    auto-rule-4

event-accessor-declarations:
    add-accessor-declaration   remove-accessor-declaration
    remove-accessor-declaration   add-accessor-declaration

add-accessor-declaration:
    attributes?   'add'   block

remove-accessor-declaration:
    attributes?   'remove'   block

indexer-declaration:
    attributes?   indexer-modifier*   indexer-declarator   '{'   accessor-declarations   '}'

indexer-modifier: one of
    new
    public
    protected
    internal
    private 
    virtual
    sealed
    override
    abstract
    extern

indexer-declarator:
    type   'this'   '['   formal-parameter-list   ']'
    type   interface-type   '.'   'this'   '['   formal-parameter-list   ']'

operator-declaration:
    attributes?   operator-modifier+   operator-declarator   operator-body

operator-modifier: one of
    public
    static
    extern

operator-declarator:
    unary-operator-declarator
    binary-operator-declarator
    conversion-operator-declarator

unary-operator-declarator:
    type   'operator'   overloadable-unary-operator   '('   type   identifier   ')'

overloadable-unary-operator: one of
    +   -   !   ~   ++   --   true   false

binary-operator-declarator:
    type   'operator'   overloadable-binary-operator   '('   type   identifier   ','   type   identifier   ')'

overloadable-binary-operator: one of
    +   -   *   /   %   &   |   ^   <<   >>   ==   !=   >   <   >=   <=

conversion-operator-declarator:
    'implicit'   'operator'   type   '('   type   identifier   ')'
    'explicit'   'operator'   type   '('   type   identifier   ')'

operator-body:
    auto-rule-1

constructor-declaration:
    attributes?   constructor-modifier*   constructor-declarator   constructor-body

constructor-modifier: one of
    public
    protected
    internal
    private
    extern

constructor-declarator:
    identifier   '('   formal-parameter-list?   ')'   constructor-initializer?

constructor-initializer:
    ':base('   argument-list?   ')'
    ':this('   argument-list?   ')'

constructor-body:
    auto-rule-1

static-constructor-declaration:
    attributes?   static-constructor-modifiers   identifier   '('   ')'   static-constructor-body

static-constructor-modifiers:
    'extern'? 'static'
    'static' 'extern'?

static-constructor-body:
    auto-rule-1

destructor-declaration:
    attributes?   'extern'?   '~'   identifier   '('   ')'    destructor-body

destructor-body:
    auto-rule-1

### C.2.8 Structs

struct-declaration:
    attributes?   struct-modifier*   'struct'   identifier   struct-interfaces?   struct-body   ';'?

struct-modifier:
    auto-rule-2

struct-interfaces:
    ':'   interface-type-list

struct-body:
    '{'   struct-member-declaration*   '}'

struct-member-declaration:
    constant-declaration
    field-declaration
    method-declaration
    property-declaration
    event-declaration
    indexer-declaration
    operator-declaration
    constructor-declaration
    static-constructor-declaration
    type-declaration

### C.2.9 Arrays

array-type:
    non-array-type   rank-specifier*

non-array-type:
    type

array-initializer:
    '{'   variable-initializer-list?   '}'
    '{'   variable-initializer-list   ','   '}'

variable-initializer-list:
    variable-initializer variable-initializer-tail*

variable-initializer-tail:
    ','   variable-initializer

### C.2.10 Interfaces

interface-declaration:
    attributes?   interface-modifier*   'interface'   identifier   interface-base?   interface-body   ';'?

interface-modifier:
    auto-rule-2

interface-base:
    ':'   interface-type-list

interface-body:
    '{'   interface-member-declaration*   '}'

interface-member-declaration:
    interface-method-declaration
    interface-property-declaration
    interface-event-declaration
    interface-indexer-declaration

interface-method-declaration:
    attributes?   'new'?   return-type   identifier   '('   formal-parameter-list?   ')'   ';'

interface-property-declaration:
    attributes?   'new'?   type   identifier   '{'   interface-accessors   '}'

interface-accessors:
    attributes?   'get'   ';'   attributes?   'set'   ';'
    attributes?   'set'   ';'   attributes?   'get'   ';'
    attributes?   'get'   ';'
    attributes?   'set'   ';'

interface-event-declaration:
    attributes?   'new'?   'event'   type   identifier   ';'

interface-indexer-declaration:
    attributes?   'new'?   type   'this'   '['   formal-parameter-list   ']'   '{'   interface-accessors   '}'

### C.2.11 Enums

enum-declaration:
    attributes?   enum-modifier*   'enum'   identifier   enum-base?   enum-body   ';'?

enum-base:
    ':'   integral-type

enum-body:
    '{'   enum-member-declaration*   '}'
    '{'   enum-member-declarations   ','   '}'

enum-modifier:
    auto-rule-2

enum-member-declarations:
    enum-member-declaration enum-member-declaration-tail*

enum-member-declaration-tail:
    ','   enum-member-declaration

enum-member-declaration:
    attributes?   identifier enum-member-decl-right?  

enum-member-decl-right:
    '='   constant-expression


### C.2.12 Delegates

delegate-declaration:
    attributes?   delegate-modifier*   'delegate'   return-type   identifier   '('   formal-parameter-list?   ')'   ';'

delegate-modifier:
    auto-rule-2

### C.2.13 Attributes

global-attributes:
    global-attribute-section+

global-attribute-section:
    '['   global-attribute-target-specifier   attribute-list  ','? ']'

global-attribute-target-specifier:
    global-attribute-target   ':'

global-attribute-target: one of
    assembly
    module

attributes:
    attribute-section*

attribute-section:
    '['   attribute-target-specifier?   attribute-list   ','?   ']'

attribute-target-specifier:
    attribute-target   ':'

attribute-target: one of
    field
    event
    method
    param
    property
    return

attribute-list:
    attribute attribute-tail*

attribute-tail:
    ','   attribute

attribute:
    attribute-name   attribute-arguments?

attribute-name:
    type-name

attribute-arguments:
    '('   positional-argument-list?   ')'
    '('   positional-argument-list   ','   named-argument-list   ')'
    '('   named-argument-list   ')'

positional-argument-list:
    positional-argument positional-argument-tail*

positional-argument-tail:
    ','   positional-argument

positional-argument:
    attribute-argument-expression

named-argument-list:
    named-argument named-argument-tail*

named-argument-tail:
    ','   named-argument

named-argument:
    identifier   '='   attribute-argument-expression

attribute-argument-expression:
    expression

### C.4 auto-created optimizations

auto-rule-1:
    block
    ';'

# used by method-body:, accessor-body:, operator-body:, constructor-body:, static-constructor-body:, destructor-body:

auto-rule-2: one of
    new
    public
    protected
    internal
    private

# used by constant-modifier:, struct-modifier:, interface-modifier:, enum-modifier:, delegate-modifier:

auto-rule-3:
    expression
    array-initializer

# used by local-variable-initializer:, variable-initializer:

auto-rule-4: one of
    new
    public
    protected
    internal
    private
    static
    virtual
    sealed
    override
    abstract
    extern

# used by method-modifier:, property-modifier:, event-modifier:


